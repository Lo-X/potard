jQuery(function(a){jQuery.fn.potard=function(e){var b=jQuery.extend({min:0,max:100,color:"#81BE64",width:200,height:200,radius:100,offset:0,thickness:20,lineColor:"#fff",shadow:true,shadowOffsetX:2,shadowOffsetY:0,shadowBlur:4,shadowColor:"rgba(0,0,0,0.3)"},e);return this.each(function(){var l=a(this);var k=jQuery.extend(jQuery.extend([],b),l.data());k.width=k.radius*2;k.height=k.radius*2;l.addClass("potard_value");console.log(k);var j=((a(this).val())?a(this).val():((a(this).text())?a(this).text():"0"));var i=(j-k.min)/(k.max-k.min);l.wrap('<div class="potard_wrap" />');l.parents(".potard_wrap").css({width:k.width+"px",height:k.height+"px"});l.css({width:"100%",height:"100%","text-align":"center","line-height":k.height+"px"});var h=l.parent();$circle=a('<canvas height="'+k.height+'px" width="'+k.width+'px"/>');$gauge=a('<canvas height="'+k.height+'px" width="'+k.width+'px"/>');h.append($circle);h.append($gauge);var f=0;var g=$circle[0].getContext("2d");g.beginPath();g.lineWidth=k.thickness;g.strokeStyle=k.lineColor;if(k.shadow){g.shadowOffsetX=k.shadowOffsetX;g.shadowOffsetY=k.shadowOffsetY;g.shadowBlur=k.shadowBlur;g.shadowColor=k.shadowColor;f=(k.shadowOffsetX>k.shadowOffsetY)?k.shadowOffsetX:k.shadowOffsetY}g.arc(k.width/2,k.height/2,k.radius-f-k.thickness/2,0,2*Math.PI);g.stroke();var g=$gauge[0].getContext("2d");c(k,i,l,g,f);h.click(function(m){m.preventDefault();c(k,d(m,h,k),l,g,f)});h.mousedown(function(m){m.preventDefault();h.bind("mousemove",(function(n){c(k,d(n,h,k),l,g,f)}))}).mouseup(function(m){m.preventDefault();h.unbind("mousemove")})});function d(i,h,j){var f=i.pageX-h.offset().left-j.width/2;var k=i.pageY-h.offset().top-j.height/2;var g=(Math.atan2(f,-k)-j.offset/180*Math.PI)/(2*Math.PI);if(g<0){g+=1}return g}function c(j,h,k,g,f){g.clearRect(0,0,j.width,j.height);g.beginPath();g.lineWidth=j.thickness;g.strokeStyle=j.color;g.arc(j.width/2,j.height/2,j.radius-f-j.thickness/2,(-1/2+j.offset/180)*Math.PI,h*2*Math.PI+(-1/2+j.offset/180)*Math.PI);g.stroke();var i=Math.round(h*(j.max-j.min)+j.min);if(k[0].tagName=="INPUT"){k.val(i)}else{k.text(i)}}}});