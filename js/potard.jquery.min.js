jQuery(function(f){jQuery.fn.potard=function(k){function j(b,a,c){var d=b.pageX-a.offset().left-c.width/2;b=b.pageY-a.offset().top-c.height/2;c=(Math.atan2(d,-b)-c.offset/180*Math.PI)/(2*Math.PI);0>c&&(c+=1);return c}function h(b,a,c,d,f){d.clearRect(0,0,b.width,b.height);d.beginPath();d.lineWidth=b.thickness;d.strokeStyle=b.color;d.arc(b.width/2,b.height/2,b.radius-f-b.thickness/2,(-0.5+b.offset/180)*Math.PI,2*a*Math.PI+(-0.5+b.offset/180)*Math.PI);d.stroke();b=Math.round(a*(b.max-b.min)+b.min); "INPUT"==c[0].tagName?c.val(b):c.text(b)}var l=jQuery.extend({min:0,max:100,color:"#81BE64",width:200,height:200,radius:100,offset:0,thickness:20,lineColor:"#fff",shadow:!0,shadowOffsetX:2,shadowOffsetY:0,shadowBlur:4,shadowColor:"rgba(0,0,0,0.3)",lock:!1,mousecursor:"pointer"},k);return this.each(function(){var b=f(this),a=jQuery.extend(jQuery.extend([],l),b.data());a.width=2*a.radius;a.height=2*a.radius;b.addClass("potard_value");var c=((f(this).val()?f(this).val():f(this).text()?f(this).text(): 0)-a.min)/(a.max-a.min);b.wrap('<div class="potard_wrap" />');b.parents(".potard_wrap").css({width:a.width+"px",height:a.height+"px",cursor:a.mousecursor});b.css({width:"100%",height:"100%","text-align":"center","line-height":a.height+"px"});var d=b.parent();$circle=f('<canvas height="'+a.height+'px" width="'+a.width+'px"/>');$gauge=f('<canvas height="'+a.height+'px" width="'+a.width+'px"/>');d.append($circle);d.append($gauge);var g=0,e=$circle[0].getContext("2d");e.beginPath();e.lineWidth=a.thickness; e.strokeStyle=a.lineColor;a.shadow&&(e.shadowOffsetX=a.shadowOffsetX,e.shadowOffsetY=a.shadowOffsetY,e.shadowBlur=a.shadowBlur,e.shadowColor=a.shadowColor,g=a.shadowOffsetX>a.shadowOffsetY?a.shadowOffsetX:a.shadowOffsetY);e.arc(a.width/2,a.height/2,a.radius-g-a.thickness/2,0,2*Math.PI);e.stroke();e=$gauge[0].getContext("2d");h(a,c,b,e,g);a.lock||(d.click(function(c){c.preventDefault();h(a,j(c,d,a),b,e,g)}),d.mousedown(function(c){c.preventDefault();d.bind("mousemove",function(c){h(a,j(c,d,a),b,e, g)})}).mouseup(function(a){a.preventDefault();d.unbind("mousemove")}))})}});